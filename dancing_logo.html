<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dancing Logo</title>
  <style>
    body {
      background: #fff;
      color: #111;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    svg {
      width: 900px;
      height: auto;
      display: block;
      margin: 20px auto 0 auto;
    }
    .controls {
      margin-top: 10px;
    }
    .svg-outer-container {
  width: 1100px;
  overflow: visible;
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 150px auto 0 auto;
}
  </style>
</head>
<body>
  <!-- <h1>Dancing Logo - Stayin' Alive</h1> -->
  <!-- Audio controls -->
  <div class="controls">
    <audio id="audio" src="StayinAlive-full.mp3" controls></audio>
  </div>

  <!-- SVG Logo -->
  <div class="svg-outer-container">
  <div id="svg-container">
    <!-- SVG will be injected here -->
  </div>
  </div>

  <script>
  // --- SVG CODE ---
  const svgCode = `<?xml version="1.0" encoding="utf-8"?>
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
  viewBox="-60 0 977 243" style="enable-background:new 0 0 857 243;" xml:space="preserve">
<style type="text/css">
  .st0{clip-path:url(#SVGID_00000146486375910471379410000016447016509975304356_);}
  .st1{fill:#001A3E;}
  .st2{fill:#2A4AFC;}
</style>
<g>
  <defs>
    <rect id="SVGID_1_" y="0" width="857" height="242.4"/>
  </defs>
  <clipPath id="SVGID_00000093886875221795508850000001462978281969594247_">
    <use xlink:href="#SVGID_1_"  style="overflow:visible;"/>
  </clipPath>
  <g transform="translate(60,0)">
    <path class="st1" d="M340,128.5h-24.7v46.3h-20.9V47.7h50.9c5.4,0,10.7,1,15.7,3.1c5,2,9.5,5.1,13.3,8.9c3.8,3.8,6.8,8.3,8.9,13.3c2,5,3.1,10.3,3.1,15.7c-0.1,8-2.5,15.7-7,22.3c-4.5,6.6-10.8,11.6-18.2,14.6l28.9,49.4h-22.9L340,128.5z M315.3,109.8h30c11.1,0,20-9.4,20-21.3c0-12-8.9-21.2-20-21.2h-30L315.3,109.8z"/>
    <path class="st1" d="M487.6,84v90.8H468v-13.1c-6.9,9.6-17.6,15.4-31.8,15.4c-24.7,0-45.2-20.9-45.2-47.8c0-27.1,20.5-47.8,45.2-47.8c14.2,0,24.9,5.8,31.8,15.3V84H487.6z M468,129.4c0-16.9-12.4-29.1-28.7-29.1s-28.7,12.2-28.7,29.1s12.4,29.1,28.7,29.1S468,146.3,468,129.4L468,129.4z"/>
    <path class="st1" d="M589.9,84l-35.4,90.8h-22.7L496.3,84h21.4l25.4,69l25.2-69H589.9z"/>
    <path class="st1" d="M639.4,159.2c10.9,0,19.1-4.9,23.4-11.3l16.2,9.4c-8.4,12.4-22,19.8-39.8,19.8c-30,0-49.4-20.5-49.4-47.8c0-26.9,19.4-47.8,48-47.8c27.1,0,45.6,21.8,45.6,48c-0.1,2.7-0.3,5.5-0.7,8.2h-72.3C613.5,151.9,624.9,159.2,639.4,159.2z M663.6,121.8c-2.7-15.6-14.2-22.3-26-22.3c-14.7,0-24.7,8.7-27.4,22.3H663.6z"/>
    <path class="st1" d="M697,42.2h19.6v132.6H697V42.2z"/>
    <path class="st1" d="M732.9,57.9c0-2.5,0.7-4.9,2.1-7c1.4-2.1,3.3-3.7,5.6-4.6c2.3-0.9,4.8-1.2,7.2-0.7c2.4,0.5,4.7,1.7,6.4,3.4c1.8,1.8,2.9,4,3.4,6.4c0.5,2.4,0.2,5-0.7,7.2c-0.9,2.3-2.6,4.2-4.6,5.6c-2.1,1.4-4.5,2.1-7,2.1c-3.3,0-6.5-1.3-8.9-3.7C734.3,64.4,732.9,61.2,732.9,57.9L732.9,57.9z M735.7,84h19.6v90.8h-19.6V84z"/>
    <path class="st1" d="M857,119.1v55.8h-19.6v-53.8c0-13.8-8-21.1-20.3-21.1c-12.9,0-23.1,7.6-23.1,26.2v48.7h-19.6V84H794v11.6c6-9.4,15.8-14,28.2-14C842.5,81.7,857,95.5,857,119.1z"/>
    <path class="st2" d="M170.7,96.1L125,63.4L79.4,96.1l17.5,53.1h56.2L170.7,96.1z M106.3,136.1L94.7,101L125,79.4l30.3,21.7l-11.6,35H106.3z"/>
    <path class="st2" d="M213.2,100.4l17.2-23.8l-27.9-9.2v-63l-60.2,19.2L125,0l-17.3,23.8L47.5,4.3v63.1l-27.9,9.1l17.3,23.9L0,151.4l59.8,19.7v29.5l28.1-9.1l37.2,50.8l37.1-50.9l28.1,9.2v-29.7l59.8-19.4L213.2,100.4z M185,135.2l2.9-8.9l5.3,1.7l12.1-16.6l23.9,33.2l-38.9,12.6v-20.4L185,135.2z M100.9,187.3l19.5-6.3v-5.5h9.3v5.5l19.5,6.3L125,220.3L100.9,187.3z M107.4,162.5v9.1l-34.7,11.2v-36.5l8.6-2.8L70.5,110l-8.6,2.8L40.6,83.4L75.1,72l5.3,7.3l28.5-20.7l-5.3-7.3L125,22l21.4,29.3l-5.3,7.4l28.5,20.7L175,72l34.5,11.3l-21.3,29.4l-8.6-2.8l-10.9,33.6l8.6,2.8v36.4l-34.7-11.2v-9H107.4z M189.5,63.2L170,56.9l-3.2,4.4l-7.5-5.5l3.3-4.5l-12.1-16.6l39.1-12.6L189.5,63.2z M87.6,51.3l2.4,3.3l0.9,1.2l-7.5,5.5L80,56.8l-19.6,6.4v-41l39.1,12.6L87.6,51.3z M65,135.2l-5.2,1.7v20.6l-38.9-12.8l24-33.1l12,16.6l5.3-1.7L65,135.2z"/>
  </g>
</g>
</svg>`;

document.getElementById('svg-container').innerHTML = svgCode;

const audio = document.getElementById('audio');
let svgDoc = document.querySelector('#svg-container svg');

function getSVGElements() {
  svgDoc = document.querySelector('#svg-container svg');
  // Only animate .st2 (logo) paths
  const logoParts = Array.from(svgDoc.querySelectorAll('.st2'));
  return { logoParts };
}

let audioCtx, source, analyser, dataArray, bufferLength, animationId;
let beatThreshold = 20; // Lowered for sensitivity
let lastBeatTime = 0;
let beatCount = 0;
let logoActiveParts = 1;

function setupAudioAnalysis() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  source = audioCtx.createMediaElementSource(audio);
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 2048;
  bufferLength = analyser.frequencyBinCount;
  dataArray = new Uint8Array(bufferLength);
  source.connect(analyser);
  analyser.connect(audioCtx.destination);
}

function animateSVGOnBeat() {
  const { logoParts } = getSVGElements();
  analyser.getByteTimeDomainData(dataArray);
  let sum = 0;
  for (let i = 0; i < bufferLength; i++) {
    let val = dataArray[i] - 128;
    sum += val * val;
  }
  let energy = Math.sqrt(sum / bufferLength);
  let now = audio.currentTime;

  // Detect beat
  if (energy > beatThreshold && now - lastBeatTime > 0.3) {
    lastBeatTime = now;
    beatCount++;
    // Animate logo parts (arms) with random direction and timing
    for (let i = 0; i < logoParts.length; i++) {
      if (i < logoActiveParts) {
        // Randomize direction and distance
        let direction = (Math.random() > 0.5 ? 1 : -1) * (6 + Math.random() * 4); // 6-10px
        let yMove = (Math.random() - 0.5) * 4; // -2 to +2px for a little vertical wiggle
        logoParts[i].setAttribute('transform', `translate(${direction},${yMove})`);
        setTimeout(() => {
          logoParts[i].setAttribute('transform', `translate(0,0)`);
        }, 180 + Math.random() * 120); // 180-300ms
      }
    }
    // Gradually add more logo parts to the dance
    if (logoActiveParts < logoParts.length && beatCount % 2 === 0) {
      logoActiveParts++;
    }
  }
  animationId = requestAnimationFrame(animateSVGOnBeat);
}

audio.addEventListener('play', () => {
  if (!audioCtx) setupAudioAnalysis();
  if (audioCtx.state === 'suspended') audioCtx.resume();
  beatCount = 0;
  logoActiveParts = 1;
  lastBeatTime = 0;
  animationId = requestAnimationFrame(animateSVGOnBeat);
});
audio.addEventListener('pause', () => {
  if (animationId) cancelAnimationFrame(animationId);
});
audio.addEventListener('ended', () => {
  if (animationId) cancelAnimationFrame(animationId);
});
</script>
</body>
</html>
